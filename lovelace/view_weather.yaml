##########################################  HERE BEGINS THE WEATHER TAB  ##########################################
title: Weather
icon: 'mdi:weather-cloudy'
badges: []
cards:
  - cards:
      - type: weather-forecast
        entity: weather.home
      - type: picture-glance
        title: Living room
        entities:
          - entity: weather.home
            attribute: temperature
            show_state: true
          - entity: weather.home
            attribute: humidity
            show_state: true
            suffix: '%'
        camera_image: camera.buienradar
      - type: 'custom:apexcharts-card'
        graph_span: 2h
        span:
          start: minute
        header:
          title: Precipitation
          show: true
        apex_config:
          annotations:
            position: front
            yaxis:
              - y: 0.2
                borderColor: '#00E396'  # Greenish color for low intensity
                label:
                  borderColor: '#00E396'
                  text: 'Light'
                  style:
                    background: 'transparent'
                    color: '#00E396'  # Text color matches the line color
                    fontSize: '10px'
                    fontFamily: 'Helvetica, Arial, sans-serif'
              - y: 1
                borderColor: '#FEB019'  # Amber color for medium intensity
                label:
                  borderColor: '#FEB019'
                  text: 'Moderate'
                  style:
                    background: 'transparent'
                    color: '#FEB019'
                    fontSize: '10px'
                    fontFamily: 'Helvetica, Arial, sans-serif'
              - y: 2.5
                borderColor: '#FF4560'  # Red color for high intensity
                label:
                  borderColor: '#FF4560'
                  text: 'Heavy'
                  style:
                    background: 'transparent'
                    color: '#FF4560'
                    fontSize: '10px'
                    fontFamily: 'Helvetica, Arial, sans-serif'
        yaxis:
          - min: 0
            max: ~3
            apex_config:
              tickAmount: 1
        series:
          - entity: sensor.precipitation_forecast
            float_precision: 1
            type: area
            color: '#87ceeb'
            data_generator: |
              console.log(entity.attributes.precipitation_raw.map(item => [new Date(item.datetime).getTime(), item.precipitation]));
              return entity.attributes.precipitation_raw.map(item => {
                return [new Date(item.datetime).getTime(), item.precipitation];
              });
      - entities:
          - entity: sensor.entry_average_illuminance
            name: Entry
          - entity: sensor.hallway_1st_floor_average_illuminance
            name: Hallway 1st Floor
          - entity: sensor.hallway_2nd_floor_average_illuminance
            name: Hallway 2nd Floor
          - entity: sensor.study_average_illuminance
            name: Study
          - entity: sun.sun
            name: Night
            color: gray
            show_line: false
            show_points: false
            show_legend: false
            y_axis: secondary
        state_map:
          - value: "below_horizon"
            label: Night
          - value: "above_horizon"
            label: Day
        icon: mdi:weather-sunny
        name: Light
        smoothing: false
        hours_to_show: 48
        points_per_hour: 2
        hour24: true
        font_size: 70
        height: 250
        line_width: 2.5
        show:
          labels_secondary: false
        lower_bound: 0
        type: custom:mini-graph-card
    type: vertical-stack
  - cards:
      - type: glance
        name: CO2
        entities:
          - entity: sensor.mh_z19_co2_value
            name: Bedroom
            icon: mdi:bed
          - entity: sensor.study_co2
            name: Study
            icon: mdi:desktop-tower-monitor
          - entity: sensor.livingroom_co2
            name: Living Room
            icon: mdi:sofa
          - entity: sensor.shed_co2
            name: Shed
            icon: mdi:greenhouse
      - type: glance
        entities:
          - entity: switch.fan_speed_override
            name: Fan Override
            icon: mdi:fan-alert
            tap_action:
              action: toggle
          - entity: number.override_fan_speed
            name: Speed
            icon: mdi:fan
          - entity: number.override_fan_duration
            name: Duration
            icon: mdi:fan-clock
      - type: custom:mini-graph-card
        name: Ventilation
        entities:
          - entity: fan.ventilation_system_2
            name: Current Speed
            icon: mdi:fan
            attribute: percentage
        hours_to_show: 24
        points_per_hour: 10
        line_width: 4
        upper_bound: 100
        lower_bound: 0
        hour24: true
      - type: glance
        entities:
          - entity: sensor.temperature_outside
            name: Outside
          # - entity: sensor.woonkamer_temperatuur
          #   name: Living room
          # - entity: sensor.slaapkamer3_temperatuur
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.temperature_outside
            name: Outside
            color: '#33ff61'
            show_fill: false
          - entity: sensor.temperature_livingroom
            name: Living room
            color: '#ffc733'
            show_fill: false
          - entity: sensor.study_multi_sensor_temperature
            name: Study Up
            color: '#f8ff33'
            show_fill: false
          - entity: sensor.study_multi_sensor_2_temperature
            name: Study Down
            color: '#ffe433'
            show_fill: false
          - entity: sensor.temperature_bedroom
            name: Bedroom
            color: '#ff7a33'
            show_fill: false
          - entity: sensor.temperature_bathroom
            name: Bathroom
            color: '#ff3c33'
            show_fill: false
        hours_to_show: 24
        points_per_hour: 5
        hour24: true
        font_size: 70
        height: 250
        line_width: 4
        show:
          labels_secondary: false
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.shed_aqm_temperature
            name: Shed
            color: '#33ff63'
            show_fill: false
          - entity: sensor.rabbits_temperature
            name: Rabbits
            color: '#33ffff'
            show_fill: false
          - entity: sensor.temperature_fridge
            name: Fridge
            color: '#336dff'
            show_fill: false
        hours_to_show: 48
        points_per_hour: 2
        hour24: true
        font_size: 70
        height: 200
        line_width: 4
        show:
          labels_secondary: false
    type: vertical-stack
  # - cards:
  #     - entity: climate.electric_blanket
  #       type: thermostat
  #     - entity: input_number.bed_preheat_temp
  #       type: custom:slider-entity-row
  #     - entity: input_number.bed_postheat_temp
  #       type: custom:slider-entity-row
  #     - entity: input_number.bed_preheat_time
  #       type: custom:slider-entity-row
  #     - type: horizontal-stack
  #       cards:
  #       - entity: script.bed_preheating
  #         type: entity-button
  #         name: 'Enable bed preheating'
  #         icon_height: 50
  #         tap_action:
  #           action: call-service
  #           service: script.bed_preheating
  #           # service_data:
  #           #   entity_id: script.bed_preheating
  #       - entity: script.bed_preheating
  #         type: entity-button
  #         name: 'Turn off blanket'
  #         icon_height: 50
  #         tap_action:
  #           action: call-service
  #           service: script.turn_off_bed_preheating
  #   type: vertical-stack
  - type: vertical-stack
    cards:
      - type: 'custom:mini-graph-card'
        entities:
          - entity: sensor.heatpump_tapwater_temperature
            name: Current Temperature
            show_state: true
            show_fill: false
          - color: yellow
            entity: number.heatpump_tapwater_target_temperature
            name: Tapwater Target
            show_legend: false
            show_line: false
            show_points: false
            smoothing: false
        hours_to_show: 12
        hour24: true
        font_size: 70
        height: 250
        line_width: 3
        lower_bound: 30
        upper_bound: 60
        name: Tapwater Temperature
        points_per_hour: 5
        decimals: 1
      - type: glance
        entities:
          - entity: switch.heatpump_tapwater_power_saving_mode
            name: Power Saving
          - entity: switch.heatpump_tapwater_heatup_mode
            name: Quick Heatup
  - cards:
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.heatpump_flow_in_temperature
            name: Verwarming Aanvoer
            color: '#33ff61'
            show_fill: false
          - entity: sensor.heatpump_flow_out_temperature
            name: Verwarming Retour
            color: '#ffc733'
            show_fill: false
          - entity: sensor.heatpump_heat_source_output_temperature
            name: Bron Uitgang
            color: '#f8ff33'
            show_fill: false
          - entity: sensor.heatpump_heat_source_input_temperature
            name: Bron Ingang
            color: '#ff7a33'
            show_fill: false
        hours_to_show: 24
        points_per_hour: 5
        hour24: true
        font_size: 70
        height: 250
        line_width: 4
        upper_bound: 30
        lower_bound: 5
        show:
          labels_secondary: false
      - type: glance
        entities:
          - entity: sensor.heatpump_flow_in_temperature
            name: Verwarming Aanvoer
          - entity: sensor.heatpump_flow_out_temperature
            name: Verwarming Retour
          - entity: sensor.heatpump_heat_source_output_temperature
            name: Bron Aanvoer
          - entity: sensor.heatpump_heat_source_input_temperature
            name: Bron Retour
      - type: custom:mini-graph-card
        entities:
          - entity: sensor.warmtebron_in_uit_delta
            name: Bron Delta
            color: '#33ff61'
            show_fill: false
          - entity: sensor.vloerverwarming_in_uit_delta
            name: Verwarming Delta
            color: '#ff7a33'
            show_fill: false
        hours_to_show: 24
        points_per_hour: 5
        hour24: true
        font_size: 70
        height: 250
        line_width: 4
        upper_bound: 5
        lower_bound: -5
        show:
          labels_secondary: false
    type: vertical-stack
